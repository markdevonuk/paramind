<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>Chat | Paramind</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body class="chat-page">
    <!-- Top Navigation -->
    <nav class="chat-navbar">
        <div class="container-fluid px-3">
            <div class="d-flex align-items-center justify-content-between w-100">
                <a class="navbar-brand" href="index.html">
                    <span class="brand-text"><span class="brand-para">para</span><span class="brand-mind">mind</span></span>
                </a>
                
                <div class="d-flex align-items-center">
                    <span class="trust-badge me-2">
                        <i class="bi bi-hospital me-1"></i>
                        <span id="userTrust">SWAST</span>
                    </span>
                    <div class="dropdown">
                        <button class="btn btn-link text-dark dropdown-toggle" type="button" data-bs-toggle="dropdown">
                            <i class="bi bi-person-circle fs-5"></i>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><span class="dropdown-item-text text-muted" id="userEmail">user@nhs.net</span></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#"><i class="bi bi-gear me-2"></i>Settings</a></li>
                            <li><a class="dropdown-item" href="#" id="upgradeBtn"><i class="bi bi-star me-2"></i>Upgrade to Pro</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item text-danger" href="index.html"><i class="bi bi-box-arrow-right me-2"></i>Sign Out</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Message Limit Banner (Free Users) -->
    <div class="message-limit-banner" id="messageLimitBanner">
        <span>Daily messages: <span class="count"><span id="messagesUsed">0</span>/5</span></span>
        <a href="#" class="upgrade-link" id="upgradeLinkBanner">
            <i class="bi bi-star-fill me-1"></i>Upgrade for unlimited
        </a>
    </div>

    <!-- Main Content Container -->
    <div class="chat-main-container">
        
        <!-- ==================== CHAT VIEW ==================== -->
        <div id="chatView" class="content-view active">
            <div class="chat-messages" id="chatMessages">
                <!-- Welcome Message -->
                <div class="welcome-message" id="welcomeMessage">
                    <div class="welcome-icon">
                        <i class="bi bi-chat-heart"></i>
                    </div>
                    <h2>Welcome to <span class="brand-text"><span class="brand-para">para</span><span class="brand-mind">mind</span></span></h2>
                    <p>I'm here to help with your clinical learning. Ask me anything or explore the menu.</p>
                    <div class="welcome-disclaimer">
                        <i class="bi bi-exclamation-triangle me-2"></i>
                        <small>Educational tool only. Always verify information and follow your trust's guidelines.</small>
                    </div>
                    
                    <!-- Random Scenario Button -->
                    <div class="quick-prompts">
                        <button class="btn btn-primary btn-lg" id="randomScenarioBtn">
                            <i class="bi bi-shuffle me-2"></i>
                            Give me a random scenario
                        </button>
                    </div>
                </div>
            </div>

            <!-- Chat Input -->
            <div class="chat-input-container">
                <div class="chat-input-wrapper">
                    <form id="chatForm">
                        <div class="input-group">
                            <textarea 
                                class="form-control" 
                                id="messageInput" 
                                placeholder="Ask a clinical question..." 
                                rows="1"
                                required
                            ></textarea>
                            <button class="btn btn-primary" type="submit" id="sendBtn">
                                <i class="bi bi-send-fill"></i>
                            </button>
                        </div>
                    </form>
                    <small class="input-disclaimer">
                        <i class="bi bi-shield-check me-1"></i>
                        Never enter real patient data.
                    </small>
                </div>
            </div>
        </div>

        <!-- ==================== SCENARIOS VIEW ==================== -->
        <div id="scenariosView" class="content-view">
            <div class="section-view">
                <!-- Main Categories -->
                <div id="scenarioCategories">
                    <div class="section-header">
                        <h1><i class="bi bi-mortarboard me-2"></i>Learning Scenarios</h1>
                        <p>Practice with interactive patient cases</p>
                    </div>
                    <div class="section-content">
                        <div class="category-grid">
                            <div class="category-card" data-category="cardiac">
                                <div class="icon"><i class="bi bi-heart-pulse"></i></div>
                                <h3>Cardiac</h3>
                                <span class="count">8 scenarios</span>
                            </div>
                            <div class="category-card" data-category="respiratory">
                                <div class="icon"><i class="bi bi-lungs"></i></div>
                                <h3>Respiratory</h3>
                                <span class="count">6 scenarios</span>
                            </div>
                            <div class="category-card" data-category="abdominal">
                                <div class="icon"><i class="bi bi-bandaid"></i></div>
                                <h3>Abdominal</h3>
                                <span class="count">7 scenarios</span>
                            </div>
                            <div class="category-card" data-category="neuro">
                                <div class="icon"><i class="bi bi-lightning-charge"></i></div>
                                <h3>Neurological</h3>
                                <span class="count">5 scenarios</span>
                            </div>
                            <div class="category-card" data-category="trauma">
                                <div class="icon"><i class="bi bi-bandaid"></i></div>
                                <h3>Trauma</h3>
                                <span class="count">6 scenarios</span>
                            </div>
                            <div class="category-card" data-category="paediatric">
                                <div class="icon"><i class="bi bi-emoji-smile"></i></div>
                                <h3>Paediatric</h3>
                                <span class="count">5 scenarios</span>
                            </div>
                            <div class="category-card" data-category="obstetric">
                                <div class="icon"><i class="bi bi-heart"></i></div>
                                <h3>Obstetric</h3>
                                <span class="count">4 scenarios</span>
                            </div>
                            <div class="category-card" data-category="mental-health">
                                <div class="icon"><i class="bi bi-chat-heart"></i></div>
                                <h3>Mental Health</h3>
                                <span class="count">4 scenarios</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Subcategory View (hidden by default) -->
                <div id="scenarioSubcategory" style="display: none;">
                    <div class="section-header">
                        <a href="#" class="back-btn" id="backToScenarioCategories">
                            <i class="bi bi-arrow-left"></i> Back
                        </a>
                        <h1 id="subcategoryTitle">Cardiac Scenarios</h1>
                        <p id="subcategoryDescription">Select a scenario to begin</p>
                    </div>
                    <div class="section-content">
                        <div class="subcategory-list" id="scenarioList">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== DIFFERENTIALS VIEW ==================== -->
        <div id="differentialsView" class="content-view">
            <div class="section-view">
                <!-- Main Categories -->
                <div id="diffCategories">
                    <div class="section-header">
                        <h1><i class="bi bi-search me-2"></i>Differentials</h1>
                        <p>Explore conditions by body system</p>
                    </div>
                    <div class="section-content">
                        <div class="category-grid">
                            <div class="category-card" data-diff-category="chest-pain">
                                <div class="icon"><i class="bi bi-heart-pulse"></i></div>
                                <h3>Chest Pain</h3>
                                <span class="count">12 conditions</span>
                            </div>
                            <div class="category-card" data-diff-category="sob">
                                <div class="icon"><i class="bi bi-lungs"></i></div>
                                <h3>Shortness of Breath</h3>
                                <span class="count">10 conditions</span>
                            </div>
                            <div class="category-card" data-diff-category="abdo-pain">
                                <div class="icon"><i class="bi bi-bandaid"></i></div>
                                <h3>Abdominal Pain</h3>
                                <span class="count">15 conditions</span>
                            </div>
                            <div class="category-card" data-diff-category="headache">
                                <div class="icon"><i class="bi bi-emoji-dizzy"></i></div>
                                <h3>Headache</h3>
                                <span class="count">8 conditions</span>
                            </div>
                            <div class="category-card" data-diff-category="altered-loc">
                                <div class="icon"><i class="bi bi-emoji-dizzy"></i></div>
                                <h3>Altered Consciousness</h3>
                                <span class="count">11 conditions</span>
                            </div>
                            <div class="category-card" data-diff-category="collapse">
                                <div class="icon"><i class="bi bi-person-dash"></i></div>
                                <h3>Collapse / Syncope</h3>
                                <span class="count">9 conditions</span>
                            </div>
                            <div class="category-card" data-diff-category="back-pain">
                                <div class="icon"><i class="bi bi-person"></i></div>
                                <h3>Back Pain</h3>
                                <span class="count">7 conditions</span>
                            </div>
                            <div class="category-card" data-diff-category="leg-pain">
                                <div class="icon"><i class="bi bi-bandaid"></i></div>
                                <h3>Leg Pain/Swelling</h3>
                                <span class="count">6 conditions</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Subcategory View (hidden by default) -->
                <div id="diffSubcategory" style="display: none;">
                    <div class="section-header">
                        <a href="#" class="back-btn" id="backToDiffCategories">
                            <i class="bi bi-arrow-left"></i> Back
                        </a>
                        <h1 id="diffSubcategoryTitle">Chest Pain Differentials</h1>
                        <p id="diffSubcategoryDescription">Tap a condition to learn more</p>
                    </div>
                    <div class="section-content">
                        <div class="subcategory-list" id="diffList">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== YOUR PATIENT VIEW ==================== -->
        <div id="patientView" class="content-view">
            <div class="section-view">
                <div class="section-header">
                    <h1><i class="bi bi-clipboard2-pulse me-2"></i>Your Patient</h1>
                    <p>Enter details for guidance on current presentation</p>
                </div>
                <div class="section-content">
                    <form id="patientForm" class="patient-form">
                        <div class="form-group">
                            <label for="patientAge">Age</label>
                            <input type="number" class="form-control" id="patientAge" placeholder="e.g., 65">
                        </div>
                        
                        <div class="form-group">
                            <label for="patientSex">Sex</label>
                            <select class="form-select" id="patientSex">
                                <option value="" disabled selected>Select...</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="chiefComplaint">Chief Complaint</label>
                            <input type="text" class="form-control" id="chiefComplaint" placeholder="e.g., Chest pain, Shortness of breath">
                        </div>
                        
                        <div class="form-group">
                            <label for="historyPresenting">History of Presenting Complaint</label>
                            <textarea class="form-control" id="historyPresenting" rows="3" placeholder="When did it start? What makes it better/worse?"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="pmh">Past Medical History</label>
                            <input type="text" class="form-control" id="pmh" placeholder="e.g., Hypertension, Diabetes, COPD">
                        </div>
                        
                        <div class="form-group">
                            <label>Vital Signs</label>
                            <div class="vital-signs-grid">
                                <div class="vital-input">
                                    <label>RR</label>
                                    <input type="number" id="vitalRR" placeholder="--">
                                </div>
                                <div class="vital-input">
                                    <label>SpO2 %</label>
                                    <input type="number" id="vitalSpO2" placeholder="--">
                                </div>
                                <div class="vital-input">
                                    <label>HR</label>
                                    <input type="number" id="vitalHR" placeholder="--">
                                </div>
                                <div class="vital-input">
                                    <label>BP</label>
                                    <input type="text" id="vitalBP" placeholder="--/--">
                                </div>
                                <div class="vital-input">
                                    <label>Temp Â°C</label>
                                    <input type="number" step="0.1" id="vitalTemp" placeholder="--">
                                </div>
                                <div class="vital-input">
                                    <label>GCS</label>
                                    <input type="number" id="vitalGCS" placeholder="--">
                                </div>
                                <div class="vital-input">
                                    <label>BM</label>
                                    <input type="number" step="0.1" id="vitalBM" placeholder="--">
                                </div>
                                <div class="vital-input">
                                    <label>Pain /10</label>
                                    <input type="number" id="vitalPain" placeholder="--">
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="additionalNotes">Additional Notes</label>
                            <textarea class="form-control" id="additionalNotes" rows="2" placeholder="Any other relevant findings..."></textarea>
                        </div>
                        
                        <button type="submit" class="btn btn-primary w-100 btn-lg mt-3">
                            <i class="bi bi-chat-dots me-2"></i>Get Guidance
                        </button>
                        
                        <div class="text-center mt-3">
                            <small class="text-muted">
                                <i class="bi bi-shield-lock me-1"></i>
                                This data is not stored. Never enter identifiable patient information.
                            </small>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="nav-item-wrapper">
            <button class="nav-item active" data-view="chatView">
                <i class="bi bi-chat-dots"></i>
                <span>Chat</span>
            </button>
        </div>
        <div class="nav-item-wrapper">
            <button class="nav-item" data-view="scenariosView">
                <i class="bi bi-mortarboard"></i>
                <span>Scenarios</span>
            </button>
        </div>
        <div class="nav-item-wrapper">
            <button class="nav-item" data-view="differentialsView">
                <i class="bi bi-search"></i>
                <span>Differentials</span>
            </button>
        </div>
        <div class="nav-item-wrapper">
            <button class="nav-item" data-view="patientView">
                <i class="bi bi-clipboard2-pulse"></i>
                <span>Your Patient</span>
            </button>
        </div>
    </nav>

    <!-- Scenario Start Modal -->
    <div class="modal fade" id="scenarioModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="scenarioModalTitle">Start Scenario</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p id="scenarioModalDescription">Description loading...</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="startScenarioBtn">
                        <i class="bi bi-play-fill me-1"></i>Start Scenario
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/app.js"></script>
    <script src="js/chat.js"></script>
</body>
</html>